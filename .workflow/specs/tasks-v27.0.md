# Tasks for v27.0

| # | Task | Agent | Layer | Size | Depends | Files | Done |
|---|------|-------|-------|------|---------|-------|------|
| T01 | Define marketplace v27 contracts. AC: CDN index schema, review payloads, publisher-verification fields, and hot-reload/isolation interfaces are documented in code and importable. | architecture-advisor | core/utils | M | - | `loofi-fedora-tweaks/utils/plugin_marketplace.py`, `loofi-fedora-tweaks/core/plugins/metadata.py`, `loofi-fedora-tweaks/core/plugins/loader.py`, `loofi-fedora-tweaks/core/plugins/sandbox.py` | [x] |
| T02 | Implement CDN-first marketplace provider with fallback. AC: provider reads signed CDN index, caches responses, and falls back to current source on CDN/network failure. | backend-builder | utils | M | T01 | `loofi-fedora-tweaks/utils/plugin_marketplace.py`, `loofi-fedora-tweaks/utils/marketplace.py`, `loofi-fedora-tweaks/utils/plugin_cdn_client.py` | [x] |
| T03 | Add tests for CDN provider + fallback behavior. AC: cache hit, cache miss, CDN timeout, malformed index, and fallback success/failure are covered with mocks. | test-writer | tests | M | T02 | `tests/test_plugin_marketplace_cdn.py`, `tests/test_plugin_marketplace.py` | [x] |
| T04 | Extend plugin metadata for ratings/reviews and verification state. AC: metadata parsing supports rating aggregate, review count, and verified publisher fields with backward compatibility. | backend-builder | core/plugins | S | T01 | `loofi-fedora-tweaks/core/plugins/metadata.py`, `loofi-fedora-tweaks/utils/plugin_marketplace.py` | [x] |
| T05 | Implement ratings/reviews marketplace API operations. AC: fetch reviews, submit review, and aggregate rating retrieval work with clear error mapping and input validation. | backend-builder | utils | M | T02, T04 | `loofi-fedora-tweaks/utils/plugin_marketplace.py`, `loofi-fedora-tweaks/cli/main.py` | [x] |
| T06 | Add tests for review API + CLI review paths. AC: success/error responses, validation failures, and JSON/plain CLI output are covered for read/write review commands. | test-writer | tests | M | T05 | `tests/test_plugin_marketplace_reviews.py`, `tests/test_cli_marketplace.py` | [x] |
| T07 | Implement verified publisher badge verification. AC: publisher identity is verified from signed metadata and exposed to UI/CLI as trusted state. | backend-builder | core/plugins | S | T02, T04 | `loofi-fedora-tweaks/core/plugins/integrity.py`, `loofi-fedora-tweaks/utils/plugin_marketplace.py`, `loofi-fedora-tweaks/cli/main.py` | [x] |
| T08 | Add tests for publisher verification logic. AC: valid signature, invalid signature, missing trust chain, and unsigned publisher paths are covered. | test-writer | tests | S | T07 | `tests/test_plugin_integrity.py`, `tests/test_plugin_marketplace_verification.py` | [x] |
| T09 | Build Community tab UX for ratings/reviews and verified badges. AC: list/detail views render badge + rating summary and allow review submission with validation feedback. | frontend-integration-builder | ui | M | T05, T07 | `loofi-fedora-tweaks/ui/community_tab.py`, `loofi-fedora-tweaks/ui/permission_consent_dialog.py` | [x] |
| T10 | Add UI/integration tests for marketplace enhancements. AC: badge rendering, rating display, review submit flow, and error states are validated with mocked backend calls. | test-writer | tests | M | T09 | `tests/test_plugin_marketplace_phase3.py`, `tests/test_plugin_integration.py` | [x] |
| T11 | Implement opt-in usage analytics pipeline. AC: telemetry is disabled by default, explicit consent is stored, and anonymized usage events are batched/sent only when enabled. | backend-builder | utils | M | T01 | `loofi-fedora-tweaks/utils/plugin_analytics.py`, `loofi-fedora-tweaks/utils/settings.py`, `loofi-fedora-tweaks/ui/community_tab.py` | [x] |
| T12 | Add tests for analytics opt-in/off behavior. AC: default-off policy, consent toggle persistence, event suppression, and send retry logic are covered. | test-writer | tests | S | T11 | `tests/test_plugin_analytics.py`, `tests/test_settings.py` | [x] |
| T13 | Implement hot reload + stronger sandbox isolation. AC: installed plugin changes can reload without app restart and isolated execution mode is enforced by policy. | backend-builder | core/plugins | L | T02, T07 | `loofi-fedora-tweaks/core/plugins/loader.py`, `loofi-fedora-tweaks/core/plugins/scanner.py`, `loofi-fedora-tweaks/core/plugins/sandbox.py`, `loofi-fedora-tweaks/utils/sandbox.py` | [x] |
| T14 | Add tests for hot reload and isolation enforcement. AC: reload success/failure rollback and isolation policy pass/fail paths are fully covered with mocked system calls. | test-writer | tests | M | T13 | `tests/test_plugin_loader.py`, `tests/test_plugin_sandbox.py`, `tests/test_sandbox.py`, `tests/test_plugin_hot_reload.py` | [x] |
| T15 | Finalize v27 docs and release alignment. AC: roadmap status, SDK docs, changelog, release notes, and version/spec alignment reflect shipped v27 behavior. | release-planner | docs/release | S | T03, T06, T08, T10, T12, T14 | `ROADMAP.md`, `docs/PLUGIN_SDK.md`, `README.md`, `CHANGELOG.md`, `docs/releases/RELEASE-NOTES-v27.0.0.md`, `loofi-fedora-tweaks/version.py`, `loofi-fedora-tweaks.spec` | [x] |
